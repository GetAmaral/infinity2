# Database Backup Information

**Backup Date**: 2025-10-20 10:50:04 UTC
**Database**: luminai_db
**User**: luminai_user

---

## Backup Files

1. **backup_20251020_105004.dump** (303K)
   - Format: PostgreSQL custom format
   - Compressed: Yes
   - Best for: Fast restoration, production use
   - Restore command: `pg_restore -U luminai_user -d luminai_db backup_20251020_105004.dump`

2. **backup_20251020_105043.sql** (840K)
   - Format: Plain SQL text
   - Compressed: No
   - Best for: Inspection, version control, manual editing
   - Restore command: `psql -U luminai_user -d luminai_db < backup_20251020_105043.sql`

---

## Database Statistics

| Metric | Count |
|--------|-------|
| **Total Tables** | 24 |
| **Generator Entities** | 75 |
| **Generator Properties** | 1,245 |

---

## Recent Changes Before Backup

### Team Property Removal (2025-10-20)
- ✅ Removed `team` property from Pipeline entity
- ✅ Property referenced non-existent `App\Entity\Team`
- ✅ Updated documentation (PIPELINE_ENTITY_QUICK_REFERENCE.md)
- ✅ Regenerated all 75 entities
- ✅ Cache cleared successfully

### PUT + PATCH Operations (2025-10-20)
- ✅ Added PATCH operation to 74 entities (alongside PUT)
- ✅ Operations: ["GetCollection","Get","Post","Put","Patch","Delete"]

### Property Cleanup (2025-10-20)
- ✅ Removed 4 AuditTrait duplicate properties
- ✅ Removed 38 OrganizationTrait duplicate properties
- ✅ Removed 386 duplicate properties across all entities
- ✅ Fixed JSON default values (boolean/integer objects → simple values)

---

## Generator Entities (75 Total)

Core CRM: Contact, Company, Deal, Pipeline, Task, Flag, Talk, TalkMessage

Calendar: Calendar, Event, Reminder, Notification, MeetingData, WorkingHour, EventAttendee, CalendarType, CalendarExternalLink, EventCategory, EventResource, EventResourceBooking, Holiday

Configuration: BillingFrequency, Brand, Competitor, DealType, DealStage, DealCategory, LostReason, WinReason, NotificationType, PipelineStage, PipelineStageTemplate, PipelineTemplate, Product, ProductBatch, ProductCategory, ProductLine, Tag, TaskTemplate, TaskType, TaxCategory

Users & Security: User, Profile, Agent, SocialMedia, TalkType, Attachment

Learning: Course, CourseModule, TreeFlow, Step, StepConnection, StepInput, StepOutput, StepQuestion, CourseLecture, StudentCourse, StudentLecture

Marketing: Campaign, LeadSource

System: Organization, Module, Role, ProfileTemplate, City, Country, SocialMediaType, TalkTypeTemplate, AgentType, NotificationTypeTemplate, EventResourceType, HolidayTemplate, TimeZone, CommunicationMethod, AuditLog

---

## Restore Instructions

### Quick Restore (Custom Format)
```bash
# Stop application
docker-compose down

# Restore database
docker cp backup_20251020_105004.dump luminai_database:/tmp/
docker-compose exec -T database pg_restore -U luminai_user -d luminai_db --clean --if-exists /tmp/backup_20251020_105004.dump

# Start application
docker-compose up -d
```

### Alternative Restore (SQL Format)
```bash
# Stop application
docker-compose down

# Restore database
docker cp backup_20251020_105043.sql luminai_database:/tmp/
docker-compose exec -T database psql -U luminai_user -d luminai_db < /tmp/backup_20251020_105043.sql

# Start application
docker-compose up -d
```

---

## Backup Verification

To verify backup integrity:
```bash
# List backup contents
pg_restore --list backup_20251020_105004.dump

# Test restore to temporary database
createdb test_restore
pg_restore -d test_restore backup_20251020_105004.dump
dropdb test_restore
```

---

**Backup Status**: ✅ Verified and Complete
**Next Backup**: Recommended before next major database changes
