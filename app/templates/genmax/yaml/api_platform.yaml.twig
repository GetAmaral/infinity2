# API Platform 4 Configuration for {{ entity.getEntityName() }}
# This file is ALWAYS regenerated by Genmax. DO NOT edit manually.
# @generated by Genmax Code Generator

resources:
  App\Entity\{{ entity.getEntityName() }}:
    shortName: {{ entity.getEntityName() }}
{% if entity.getDescription() %}
    description: {{ entity.getDescription()|json_encode|raw }}
{% endif %}

{% if entity.getApiNormalizationContext() %}
    normalizationContext:
      groups: {{ entity.getApiNormalizationContext()['groups']|json_encode|raw }}
{% endif %}

{% if entity.getApiDenormalizationContext() %}
    denormalizationContext:
      groups: {{ entity.getApiDenormalizationContext()['groups']|json_encode|raw }}
{% endif %}

{% if entity.getApiDefaultOrder() %}
    order:
{% for field, direction in entity.getApiDefaultOrder() %}
      {{ field }}: {{ direction|upper }}
{% endfor %}
{% endif %}

{% if entity.getApiSecurity() %}
    security: {{ entity.getApiSecurity()|json_encode|raw }}
{% endif %}

    operations:
{% if entity.getApiOperations() %}
{% for operation in entity.getApiOperations() %}
      - class: ApiPlatform\Metadata\{{ operation }}
{% if entity.getOperationSecurity() and entity.getOperationSecurity()[operation] is defined %}
        security: {{ entity.getOperationSecurity()[operation]|json_encode|raw }}
{% elseif entity.getApiSecurity() %}
        security: {{ entity.getApiSecurity()|json_encode|raw }}
{% endif %}
{% if entity.getOperationValidationGroups() and entity.getOperationValidationGroups()[operation] is defined %}
        validationContext:
          groups: {{ entity.getOperationValidationGroups()[operation]|json_encode|raw }}
{% elseif entity.getValidationGroups() %}
        validationContext:
          groups: {{ entity.getValidationGroups()|json_encode|raw }}
{% endif %}
{% endfor %}
{% else %}
      # Default operations - GetCollection, Get, Post, Put, Delete
      - class: ApiPlatform\Metadata\GetCollection
{% if entity.getApiSecurity() %}
        security: {{ entity.getApiSecurity()|json_encode|raw }}
{% endif %}
      - class: ApiPlatform\Metadata\Get
{% if entity.getApiSecurity() %}
        security: {{ entity.getApiSecurity()|json_encode|raw }}
{% endif %}
      - class: ApiPlatform\Metadata\Post
{% if entity.getApiSecurity() %}
        security: {{ entity.getApiSecurity()|json_encode|raw }}
{% endif %}
      - class: ApiPlatform\Metadata\Put
{% if entity.getApiSecurity() %}
        security: {{ entity.getApiSecurity()|json_encode|raw }}
{% endif %}
      - class: ApiPlatform\Metadata\Delete
{% if entity.getApiSecurity() %}
        security: {{ entity.getApiSecurity()|json_encode|raw }}
{% endif %}
{% endif %}

{# Search and filter configuration is now property-level - see properties section below #}

{% set hasPropertyConfig = false %}
{% for property in entity.getProperties() %}
{% if not property.isApiReadable() or not property.isApiWritable() or property.getApiDescription() or property.getApiExample() or property.isSubresource() or property.getFilterStrategy() or property.isFilterSearchable() or property.isFilterOrderable() or property.isFilterBoolean() or property.isFilterDate() or property.isFilterNumericRange() or property.isFilterExists() %}
{% set hasPropertyConfig = true %}
{% endif %}
{% endfor %}

{% if hasPropertyConfig %}
    # Property-level configuration
    properties:
{% for property in entity.getProperties() %}
{% if not property.isApiReadable() or not property.isApiWritable() or property.getApiDescription() or property.getApiExample() or property.isSubresource() or property.getFilterStrategy() or property.isFilterSearchable() or property.isFilterOrderable() or property.isFilterBoolean() or property.isFilterDate() or property.isFilterNumericRange() or property.isFilterExists() %}
      {{ property.getPropertyName() }}:
{% if not property.isApiReadable() %}
        readable: false
{% endif %}
{% if not property.isApiWritable() %}
        writable: false
{% endif %}
{% if property.getApiDescription() %}
        description: {{ property.getApiDescription()|json_encode|raw }}
{% endif %}
{% if property.getApiExample() %}
        example: {{ property.getApiExample()|json_encode|raw }}
{% endif %}
{% if property.isSubresource() and property.getSubresourcePath() %}
        # Subresource configuration
        subresource:
          resourceClass: App\Entity\{{ property.getTargetEntity() }}
          collection: true
          path: {{ property.getSubresourcePath()|json_encode|raw }}
{% endif %}
{% set hasFilters = property.getFilterStrategy() or property.isFilterSearchable() or property.isFilterOrderable() or property.isFilterBoolean() or property.isFilterDate() or property.isFilterNumericRange() or property.isFilterExists() %}
{% if hasFilters %}
        # Advanced filters
        filters:
{% if property.getFilterStrategy() %}
          - type: SearchFilter
            strategy: {{ property.getFilterStrategy() }}
{% endif %}
{% if property.isFilterSearchable() %}
          - type: SearchFilter
            strategy: partial
{% endif %}
{% if property.isFilterOrderable() %}
          - type: OrderFilter
{% endif %}
{% if property.isFilterBoolean() %}
          - type: BooleanFilter
{% endif %}
{% if property.isFilterDate() %}
          - type: DateFilter
{% endif %}
{% if property.isFilterNumericRange() %}
          - type: NumericFilter
{% endif %}
{% if property.isFilterExists() %}
          - type: ExistsFilter
{% endif %}
{% endif %}
{% endif %}
{% endfor %}
{% endif %}
