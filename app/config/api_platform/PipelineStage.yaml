# API Platform 4 Configuration for PipelineStage
# This file is ALWAYS regenerated by Genmax. DO NOT edit manually.
# @generated by Genmax Code Generator

resources:
  App\Entity\PipelineStage:
    shortName: PipelineStage
    description: "Pipeline stage configurations"

    # DTO configuration - processor is set per-operation to avoid affecting DELETE
    output: App\Dto\PipelineStageOutputDto

    normalizationContext:
      groups: ["pipelinestage:read"]

    denormalizationContext:
      groups: ["pipelinestage:write"]

    order:
      createdAt: DESC

    security: "is_granted('ROLE_ORGANIZATION_ADMIN')"

    operations:
      - class: ApiPlatform\Metadata\GetCollection
        security: "is_granted('ROLE_ORGANIZATION_ADMIN')"
      - class: ApiPlatform\Metadata\Get
        security: "is_granted('ROLE_ORGANIZATION_ADMIN')"
      - class: ApiPlatform\Metadata\Post
        input: App\Dto\PipelineStageInputDto
        processor: App\State\PipelineStageProcessor
        security: "is_granted('ROLE_ORGANIZATION_ADMIN')"
      - class: ApiPlatform\Metadata\Put
        input: App\Dto\PipelineStageInputDto
        processor: App\State\PipelineStageProcessor
        security: "is_granted('ROLE_ORGANIZATION_ADMIN')"
      - class: ApiPlatform\Metadata\Patch
        input: App\Dto\PipelineStageInputDto
        processor: App\State\PipelineStageProcessor
        security: "is_granted('ROLE_ORGANIZATION_ADMIN')"
      - class: ApiPlatform\Metadata\Delete
        security: "is_granted('ROLE_ORGANIZATION_ADMIN')"


    # Property-level configuration
    properties:
      organization:
        description: "Organization"
        example: "/api/organizations/01234567-89ab-cdef-0123-456789abcdef"
      description:
        description: "..."
        example: "..."
      dealStages:
        description: "Collection of deal stage transitions associated with this pipeline stage"
        example: "[{\"id\": \"0199cadd-635e-76d8-98fe-38d61ab9751f\", \"dealId\": \"...\", \"enteredAt\": \"2025-01-15T10:30:00Z\"}]"
      probability:
        description: "Win probability percentage (0-100) indicating likelihood of closing deals at this stage"
        example: "75"
      final:
        description: "Whether this is a final stage (Won or Lost) that concludes the pipeline"
        example: "false"
      won:
        description: "Whether this is a Won stage indicating successful deal closure"
        example: "false"
      active:
        description: "Whether this stage is currently active and available for use"
        example: "true"
      lost:
        description: "Whether this is a Lost stage indicating unsuccessful deal closure"
        example: "false"
      color:
        description: "Hex color code for visual identification of the stage in UI"
        example: "#3498db"
      deals:
        description: "Collection of deals currently in this pipeline stage"
        example: "[{\"id\": \"0199cadd-635e-76d8-98fe-38d61ab9751f\", \"name\": \"Acme Corp Deal\", \"value\": 50000}]"
      displayOrder:
        description: "Numeric position determining the order of stages in the pipeline (lower numbers appear first)"
        example: "2"
      migrationCriteria:
        description: "Criteria or conditions that must be met before a deal can progress to the next stage"
        example: "Budget confirmed and decision maker identified"
      next:
        description: "Reference to the next pipeline stage in the sequence (if any)"
        example: "\/api\/pipeline_stages\/0199cadd-635e-76d8-98fe-38d61ab9751f"
      pipeline:
        description: "The pipeline to which this stage belongs"
        example: "\/api\/pipelines\/0199cadd-635e-76d8-98fe-38d61ab9751f"
      previous:
        description: "Reference to the previous pipeline stage in the sequence (if any)"
        example: "\/api\/pipeline_stages\/0199cadd-635e-76d8-98fe-38d61ab9751f"
      stageName:
        description: "The name of the pipeline stage (e.g., \"Qualified\", \"Proposal Sent\", \"Negotiation\")"
        example: "Proposal Sent"
      tasks:
        description: "..."
        example: "..."
