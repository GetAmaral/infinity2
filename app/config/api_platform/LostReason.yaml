# API Platform 4 Configuration for LostReason
# This file is ALWAYS regenerated by Genmax. DO NOT edit manually.
# @generated by Genmax Code Generator

resources:
  App\Entity\LostReason:
    shortName: LostReason
    description: "Tracks and categorizes reasons for lost deals with advanced analytics capabilities. Supports win-loss analysis, competitor tracking, and actionable insights to improve win rates. Implements CRM best practices for structured data collection and longitudinal analysis."

    # DTO configuration - processor is set per-operation to avoid affecting DELETE
    output: App\Dto\LostReasonOutputDto

    normalizationContext:
      groups: ["lostreason:read"]

    denormalizationContext:
      groups: ["lostreason:write"]

    order:
      createdAt: DESC

    security: "is_granted('ROLE_ORGANIZATION_ADMIN')"

    operations:
      - class: ApiPlatform\Metadata\GetCollection
        security: "is_granted('ROLE_ORGANIZATION_ADMIN')"
      - class: ApiPlatform\Metadata\Get
        security: "is_granted('ROLE_ORGANIZATION_ADMIN')"
      - class: ApiPlatform\Metadata\Post
        input: App\Dto\LostReasonInputDto
        processor: App\State\LostReasonProcessor
        security: "is_granted('ROLE_ORGANIZATION_ADMIN')"
      - class: ApiPlatform\Metadata\Put
        input: App\Dto\LostReasonInputDto
        processor: App\State\LostReasonProcessor
        security: "is_granted('ROLE_ORGANIZATION_ADMIN')"
      - class: ApiPlatform\Metadata\Patch
        input: App\Dto\LostReasonInputDto
        processor: App\State\LostReasonProcessor
        security: "is_granted('ROLE_ORGANIZATION_ADMIN')"
      - class: ApiPlatform\Metadata\Delete
        security: "is_granted('ROLE_ORGANIZATION_ADMIN')"


    # Property-level configuration
    properties:
      organization:
        description: "Organization"
        example: "/api/organizatia/01234567-89ab-cdef-0123-456789abcdef"
      name:
        description: "The brand name"
        example: "Nike"
      description:
        description: "..."
        example: "..."
      category:
        description: "The category or classification of the lost reason (e.g., PRICING, COMPETITION, TIMING)"
        example: "PRICING"
      deals:
        writable: false
        description: "Collection of deals that were lost for this reason"
        example: "[]"
      active:
        description: "Whether this lost reason is currently active and available for selection"
        example: "true"
      default:
        description: "Whether this is the default lost reason pre-selected in forms"
        example: "false"
      sortOrder:
        description: "Display order for this lost reason in lists and dropdowns (lower numbers appear first)"
        example: "10"
      requiresNotes:
        description: "Whether additional notes are required when this lost reason is selected"
        example: "true"
      color:
        description: "Color code for visual representation in charts and reports (hex format)"
        example: "#dc3545"
      critical:
        description: "Whether this lost reason indicates a critical issue requiring immediate attention"
        example: "false"
      impact:
        description: "Business impact level of deals lost for this reason (LOW, MEDIUM, HIGH, CRITICAL)"
        example: "HIGH"
      winBackPotential:
        description: "Likelihood of winning back deals lost for this reason"
        example: "MEDIUM"
      actionable:
        description: "Whether this lost reason represents something the organization can take action to improve"
        example: "true"
      internal:
        description: "Whether this is an internal tracking reason not shared with customers"
        example: "false"
      competitorName:
        description: "The name of the competitor if this is a competition-related lost reason"
        example: "Acme Corp"
      automationRule:
        description: "JSON configuration for automated actions when this reason is selected (e.g., notifications, follow-up tasks)"
        example: "{\"notify\": [\"sales.manager@example.com\"], \"createTask\": true, \"followUpDays\": 30}"
